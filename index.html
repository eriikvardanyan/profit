<!DOCTYPE html>
<html lang="hy">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://cdn-icons-png.flaticon.com/512/1972/1972429.png" type="image/png">
    <title>7.5% Profit Quiz</title>
    <style>
        :root {
            --win-accent: #007aff;
            --win-success: #34c759;
            --win-error: #ff3b30;
            --glass: rgba(255, 255, 255, 0.85);
            --radius: 18px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background: url('./beck-stars.jpg') no-repeat center center fixed;
            background-size: cover;
            min-height: 100vh;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 10px;
        }

        #magicCanvas {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 9999;
        }

        .site-title {
            color: white;
            font-size: 28px;
            font-weight: 800;
            margin-bottom: 15px;
            text-shadow: 0 4px 10px rgba(0,0,0,0.5);
        }

        .window {
            background: var(--glass);
            backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.4);
            border-radius: var(--radius);
            box-shadow: 0 30px 60px rgba(0,0,0,0.4);
            width: 100%;
            max-width: 600px;
            position: relative;
            z-index: 10;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .window-header {
            background: rgba(255,255,255,0.5);
            height: 40px;
            display: flex;
            align-items: center;
            padding: 0 15px;
            justify-content: space-between;
            border-bottom: 1px solid rgba(0,0,0,0.05);
        }

        .mac-dots { display: flex; gap: 8px; }
        .dot { width: 11px; height: 11px; border-radius: 50%; }
        .dot.red { background: #ff5f56; }
        .dot.yellow { background: #ffbd2e; }
        .dot.green { background: #27c93f; }

        .game-info { display: flex; gap: 15px; align-items: center; }
        .hearts { color: #ff3b30; font-size: 16px; }
        .game-count { background: rgba(0,0,0,0.08); padding: 2px 8px; border-radius: 10px; font-size: 11px; font-weight: 600; }

        .content { padding: 20px; }

        .itc-select {
            border: 2px solid transparent;
            border-radius: 12px;
            transition: all 0.3s ease;
            margin-bottom: 8px;
        }
        
        .itc-select.selected-mode {
            border-color: var(--win-accent);
            box-shadow: 0 0 10px rgba(0, 122, 255, 0.3);
        }

        .itc-select__toggle {
            width: 100%; padding: 10px 15px; 
            background: #fff; color: #000;
            border: 1px solid #ddd; border-radius: 10px; 
            cursor: pointer; font-weight: 500; font-size: 14px;
            display: flex; justify-content: flex-start; align-items: center;
        }

        .mode-num {
            background: #eee;
            width: 22px; height: 22px;
            display: flex; align-items: center; justify-content: center;
            border-radius: 50%; margin-right: 12px; font-size: 11px; font-weight: 700;
        }

        .btn-play-container { display: flex; justify-content: center; width: 100%; }
        .btn-play, .btn-restart {
            background: #000; color: white; border: none; border-radius: 8px;
            padding: 8px 25px; font-size: 14px; font-weight: 600;
            cursor: pointer; margin-top: 15px; width: auto;
        }

        .data-table-container {
            background: var(--glass);
            backdrop-filter: blur(15px);
            padding: 15px; border-radius: 15px; border: 1px solid rgba(255,255,255,0.3);
            width: 95%; max-width: 900px; overflow-x: auto;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        table {
            width: 100%; border-collapse: separate; border-spacing: 2px;
            font-size: 10px; text-align: center; background: rgba(255,255,255,0.4);
        }

        td { padding: 3px; border-radius: 2px; }
        .val-top { font-weight: 700; color: #000; background: rgba(255,255,255,0.6); }
        .val-bottom { color: #333; background: rgba(240,240,240,0.5); }
        
        .highlight-cell { background-color: #8f8f8e !important; color: #000000 !important; }

        #game-screen { display: none; flex-direction: column; align-items: center; gap: 15px; }
        .target-number { font-size: 60px; font-weight: 800; color: #1d1d1f; }
        input[type="text"] {
            width: 120px; padding: 12px; border: 2px solid #ddd; border-radius: 12px;
            font-size: 24px; text-align: center; outline: none;
        }
        .btn-check { background: #000; color: white; border: none; padding: 0 20px; border-radius: 12px; cursor: pointer; }

        .history { width: 100%; height: 80px; overflow-y: auto; margin-top: 15px; border-top: 1px solid rgba(0,0,0,0.05); }
        .history-list { display: flex; flex-wrap: wrap; gap: 5px; justify-content: center; padding-top: 10px; }
        .history-item { background: rgba(0,0,0,0.05); padding: 3px 8px; border-radius: 5px; font-size: 11px; }

        .hidden { display: none !important; }
        input.correct { border-color: var(--win-success); background: #eaffef; }
        input.wrong { border-color: var(--win-error); animation: shake 0.3s; }
        @keyframes shake { 0%, 100% { transform: translateX(0); } 25% { transform: translateX(-6px); } 75% { transform: translateX(6px); } }
    </style>
</head>
<body>

<canvas id="magicCanvas"></canvas>

<div class="site-title">7.5% Profit</div>

<div class="window">
    <div class="window-header">
        <div class="mac-dots">
            <div class="dot red"></div>
            <div class="dot yellow"></div>
            <div class="dot green"></div>
        </div>
        <div class="game-info hidden" id="game-status">
            <div class="game-count" id="count-display">Խաղ: 1</div>
            <div class="hearts" id="hearts-display">❤️❤️❤️</div>
        </div>
    </div>

    <div class="content">
        <div id="setup-screen">
            <h3 style="text-align:center; margin:0 0 15px 0;">Ընտրեք ռեժիմը</h3>
            <div class="modes-container" id="modes-list">
                <div class="itc-select" id="mode-5">
                    <button class="itc-select__toggle" onclick="toggleDropdown('opt-5')">
                        <span class="mode-num">1</span> <span id="label-5">Ըստ 5 հատի</span>
                    </button>
                    <div class="itc-select__dropdown hidden" id="opt-5" style="background:white; border-radius:10px; padding:5px; margin-top:5px; max-height:150px; overflow-y:auto; color:black; font-size:13px; border: 1px solid #eee;"></div>
                </div>
                <div class="itc-select" id="mode-row">
                    <button class="itc-select__toggle" onclick="toggleDropdown('opt-row')">
                        <span class="mode-num">2</span> <span id="label-row">Ըստ տողերի</span>
                    </button>
                    <div class="itc-select__dropdown hidden" id="opt-row" style="background:white; border-radius:10px; padding:5px; margin-top:5px; color:black; font-size:13px; border: 1px solid #eee;"></div>
                </div>
                <div class="itc-select" id="mode-all">
                    <button class="itc-select__toggle" onclick="selectRange(0, 85, 'Ամբողջը', 'mode-all')">
                        <span class="mode-num">3</span> Ամբողջը
                    </button>
                </div>
            </div>
            <div class="btn-play-container">
                <button class="btn-play" onclick="initGame()">Խաղալ</button>
            </div>
        </div>

        <div id="game-screen">
            <div id="target-display" class="target-number">---</div>
            <div class="input-group" style="display:flex; gap:10px;">
                <input type="text" id="user-input" inputmode="decimal" placeholder="0.00" autocomplete="off">
                <button class="btn-check" id="main-btn" onclick="checkAnswer()">Ստուգել</button>
            </div>
            <div class="history">
                <div id="history-list" class="history-list"></div>
            </div>
        </div>
    </div>
</div>

<div class="data-table-container" id="profit-table">
    <table id="html-data-table"></table>
</div>

<script>
    const data = [
        [1.01, 11], [1.02, 9.9], [1.03, 9.05], [1.04, 8.35], [1.05, 7.77], [1.06, 7.25], [1.07, 6.8], [1.08, 6.45], [1.09, 6.1], [1.1, 5.8], [1.11, 5.55], [1.12, 5.3], [1.13, 5.1], [1.14, 4.9], [1.15, 4.7], [1.16, 4.55], [1.17, 4.4], [1.18, 4.2], [1.19, 4.15], [1.2, 4],
        [1.21, 3.9], [1.22, 3.8], [1.23, 3.7], [1.24, 3.6], [1.25, 3.55], [1.26, 3.45], [1.27, 3.4], [1.28, 3.35], [1.29, 3.25], [1.3, 3.2], [1.31, 3.15], [1.32, 3.1], [1.33, 3], [1.34, 2.95], [1.35, 2.9], [1.36, 2.89], [1.37, 2.85], [1.38, 2.8], [1.39, 2.75], [1.4, 2.7],
        [1.41, 2.69], [1.42, 2.65], [1.43, 2.6], [1.44, 2.59], [1.45, 2.55], [1.46, 2.52], [1.47, 2.5], [1.48, 2.45], [1.49, 2.44], [1.5, 2.4], [1.51, 2.39], [1.52, 2.35], [1.53, 2.34], [1.54, 2.32], [1.55, 2.3], [1.56, 2.27], [1.57, 2.25], [1.58, 2.23], [1.59, 2.21], [1.6, 2.2],
        [1.61, 2.17], [1.62, 2.15], [1.63, 2.14], [1.64, 2.12], [1.65, 2.1], [1.66, 2.09], [1.67, 2.07], [1.68, 2.05], [1.69, 2.04], [1.7, 2], [1.71, 1.99], [1.72, 1.98], [1.73, 1.97], [1.74, 1.96], [1.75, 1.95], [1.76, 1.94], [1.77, 1.93], [1.78, 1.92], [1.79, 1.91], [1.8, 1.9],
        [1.81, 1.89], [1.82, 1.88], [1.83, 1.87], [1.84, 1.86], [1.85, 1.85]
    ];

    let lives = 3;
    let gamesPlayed = 1;
    let originalPool = [], activePool = [], currentPair = null;

    function generateTable() {
        const table = document.getElementById('html-data-table');
        let html = '';
        for (let i = 0; i < data.length; i += 20) {
            let chunk = data.slice(i, i + 20);
            html += '<tr>' + chunk.map((d, idx) => `<td class="val-top ${(i+idx+1)%5===0?'highlight-cell':''}">${d[0]}</td>`).join('') + '</tr>';
            html += '<tr>' + chunk.map((d, idx) => `<td class="val-bottom ${(i+idx+1)%5===0?'highlight-cell':''}">${d[1]}</td>`).join('') + '</tr>';
            html += '<tr style="height:8px"><td colspan="20"></td></tr>';
        }
        table.innerHTML = html;
    }
    generateTable();

    function fillOptions() {
        const opt5 = document.getElementById('opt-5');
        let count = 1;
        for(let i=0; i<85; i+=5) {
            let endIdx = Math.min(i + 5, 85);
            let label = `${data[i][0]} - ${data[endIdx-1][0]}`;
            let div = document.createElement('div');
            div.style.padding = '8px'; div.style.cursor = 'pointer'; div.style.borderBottom = '1px solid #eee';
            div.innerHTML = `<span style="color:#888; margin-right:5px;">${count})</span> ${label}`;
            div.onclick = (e) => { e.stopPropagation(); selectRange(i, endIdx, label, 'mode-5'); };
            opt5.appendChild(div);
            count++;
        }
        const optRow = document.getElementById('opt-row');
        const ranges = [[0,20], [20,40], [40,60], [60,85]];
        ranges.forEach((r, idx) => {
            let label = `Տող ${idx+1} (${data[r[0]][0]}-${data[r[1]-1][0]})`;
            let div = document.createElement('div');
            div.style.padding = '8px'; div.style.cursor = 'pointer'; div.style.borderBottom = '1px solid #eee';
            div.innerHTML = `<span style="color:#888; margin-right:5px;">${idx+1})</span> ${label}`;
            div.onclick = (e) => { e.stopPropagation(); selectRange(r[0], r[1], label, 'mode-row'); };
            optRow.appendChild(div);
        });
    }
    fillOptions();

    function toggleDropdown(id) {
        document.querySelectorAll('.itc-select__dropdown').forEach(d => { if(d.id !== id) d.classList.add('hidden'); });
        document.getElementById(id).classList.toggle('hidden');
    }

    function selectRange(start, end, label, parentId) {
        originalPool = data.slice(start, end);
        document.querySelectorAll('.itc-select').forEach(el => el.classList.remove('selected-mode'));
        document.getElementById(parentId).classList.add('selected-mode');
        if(parentId === 'mode-5') document.getElementById('label-5').innerText = label;
        if(parentId === 'mode-row') document.getElementById('label-row').innerText = label;
        document.querySelectorAll('.itc-select__dropdown').forEach(d => d.classList.add('hidden'));
    }

    function initGame() {
        if (originalPool.length === 0) return alert("Խնդրում ենք ընտրել ռեժիմը!");
        lives = 3;
        updateUI();
        document.getElementById('profit-table').classList.add('hidden');
        document.getElementById('setup-screen').classList.add('hidden');
        document.getElementById('game-screen').style.display = 'flex';
        document.getElementById('game-status').classList.remove('hidden');
        activePool = [...originalPool];
        document.getElementById('history-list').innerHTML = '';
        nextRound();
    }

    function updateUI() {
        document.getElementById('hearts-display').innerText = "❤️".repeat(lives);
        document.getElementById('count-display').innerText = `Խաղ: ${gamesPlayed}`;
    }

    function nextRound() {
        if (activePool.length === 0) return endGame(true);
        const randomIndex = Math.floor(Math.random() * activePool.length);
        currentPair = activePool.splice(randomIndex, 1)[0];
        const showTop = Math.random() > 0.5;
        const displayVal = showTop ? currentPair[0] : currentPair[1];
        const targetVal = showTop ? currentPair[1] : currentPair[0];
        const display = document.getElementById('target-display');
        display.innerText = displayVal;
        display.dataset.answer = targetVal;
        const input = document.getElementById('user-input');
        input.value = ''; input.className = ''; input.style.display = 'block'; input.focus();
        const btn = document.getElementById('main-btn');
        btn.innerText = 'Ստուգել'; btn.onclick = checkAnswer; btn.className = 'btn-check';
    }

    function checkAnswer() {
        const input = document.getElementById('user-input');
        const display = document.getElementById('target-display');
        const userAnswer = input.value.trim().replace(',', '.');
        const correctAnswer = String(display.dataset.answer);
        if (userAnswer === correctAnswer) {
            input.classList.add('correct');
            addToHistory(display.innerText, correctAnswer);
            setTimeout(nextRound, 600);
        } else {
            lives--;
            updateUI();
            input.classList.add('wrong');
            setTimeout(() => input.classList.remove('wrong'), 600);
            if(lives <= 0) endGame(false);
        }
    }

    function endGame(win) {
        document.getElementById('target-display').innerText = win ? "ՀԱՂԹԱՆԱԿ" : "ՊԱՐՏՈՒԹՅՈՒՆ";
        document.getElementById('user-input').style.display = 'none';
        const btn = document.getElementById('main-btn');
        btn.innerText = 'Կրկնել'; btn.className = 'btn-restart';
        btn.onclick = () => { gamesPlayed++; initGame(); };
        if(win) startAutoFireworks();
    }

    function addToHistory(q, a) {
        const list = document.getElementById('history-list');
        const div = document.createElement('div');
        div.className = 'history-item';
        div.innerText = `${q} → ${a}`;
        list.prepend(div);
    }

    document.getElementById('user-input').addEventListener('keypress', (e) => { if (e.key === 'Enter') checkAnswer(); });

    const canvas = document.getElementById("magicCanvas");
    const ctx = canvas.getContext("2d");
    let particles = [];
    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.addEventListener("resize", resize); resize();
    
    class Particle {
        constructor(x, y, color) {
            this.x = x; this.y = y; 
            const angle = Math.random() * Math.PI * 2;
            const force = Math.random() * 6 + 1;
            this.vx = Math.cos(angle) * force; 
            this.vy = Math.sin(angle) * force; 
            this.life = 100;
            this.color = color || `rgba(255,214,10,`;
        }
        update() { 
            this.x += this.vx; 
            this.y += this.vy; 
            this.vy += 0.05; 
            this.life -= 1.5; 
        }
        draw() { 
            ctx.fillStyle = `${this.color}${this.life/100})`; 
            ctx.beginPath(); 
            ctx.arc(this.x, this.y, 2, 0, Math.PI*2); 
            ctx.fill(); 
        }
    }

    function animate() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        particles = particles.filter(p => p.life > 0);
        particles.forEach(p => { p.update(); p.draw(); });
        requestAnimationFrame(animate);
    }
    animate();

    function createFirework(x, y) {
        const colors = ['rgba(255,214,10,', 'rgba(0,122,255,', 'rgba(52,199,89,', 'rgba(255,59,48,', 'rgba(175,82,222,'];
        const color = colors[Math.floor(Math.random() * colors.length)];
        for(let i=0; i<60; i++) particles.push(new Particle(x, y, color));
    }

    function startAutoFireworks() {
        let startTime = Date.now();
        const duration = 5000; 

        const interval = setInterval(() => {
            if (Date.now() - startTime > duration) {
                clearInterval(interval);
                return;
            }
            const x = Math.random() * canvas.width;
            const y = Math.random() * (canvas.height * 0.7);
            createFirework(x, y);
        }, 300); 
    }
</script>
</body>
</html>
